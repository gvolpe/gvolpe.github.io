<!doctype html><html lang=en-us data-theme=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://gvolpe.com/images/favicon.png><title>Setting up Ghcide in Ubuntu with Nixpkgs - Gabriel Volpe</title><meta name=description content="If you use Ubuntu or any other Linux distribution (AKA distro) together with Nixpkgs, you might have noticed things don&rsquo;t play so well together. Nixpkgs ‚Ä¶"><meta property="og:title" content="Setting up Ghcide in Ubuntu with Nixpkgs"><meta property="og:description" content="If you use Ubuntu or any other Linux distribution (AKA distro) together with Nixpkgs, you might have noticed things don&rsquo;t play so well together. Nixpkgs ‚Ä¶"><meta property="og:type" content="article"><meta property="og:url" content="https://gvolpe.com/blog/setting-up-ghcide-nixpkgs-ubuntu/"><meta property="og:site_name" content="Gabriel Volpe"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Setting up Ghcide in Ubuntu with Nixpkgs"><meta name=twitter:description content="If you use Ubuntu or any other Linux distribution (AKA distro) together with Nixpkgs, you might have noticed things don&rsquo;t play so well together. Nixpkgs ‚Ä¶"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://gvolpe.com/css/style.css><script defer src=https://analytics.gvolpe.com/script.js data-website-id=d1402dba-c29e-4232-abe6-159c15ae2ff7></script></head><body><main><div id=post-overlay-id class="post-overlay active"><div class=reading-progress></div><div class=post-overlay-backdrop></div><div id=post-overlay-content-id class=post-overlay-content style=position:relative;min-height:100vh;padding:0;transform:translateY(0)><div class=post-overlay-header><div class=post-overlay-title><a href=/ class=overlay-site-title>Gabriel Volpe</a></div><button class=post-overlay-close aria-label="Close post" onclick='window.location.href="/"'>
<i class="fas fa-times"></i></button></div><div class=post-layout><article class=post-content><header class=post-header><div class=post-meta><span class=post-date>2020.03.21</span><div class=reading-time-post><span class=coffee-cups>üìöüìöüìöüìöüìö
</span><span>7 min read</span></div></div><h1 class=post-title>Setting up Ghcide in Ubuntu with Nixpkgs</h1><div class=post-tags-header><a href=https://gvolpe.com/tags/haskell class=post-tag>haskell</a>
<a href=https://gvolpe.com/tags/nix class=post-tag>nix</a>
<a href=https://gvolpe.com/tags/ide class=post-tag>ide</a></div></header><div class=post-body><p>If you use <a href=https://ubuntu.com/>Ubuntu</a> or any other Linux distribution (AKA <em>distro</em>) together with <a href=https://nixos.org/nixpkgs/>Nixpkgs</a>, you might have noticed things don&rsquo;t play so well together. Nixpkgs has been mainly designed to work seamlessly in <a href=https://nixos.org/nixos/>Nix OS</a>; other distros are second class citizens.</p><p>Quoting the <a href=https://github.com/digital-asset/ghcide>Ghcide</a> repository, it is defined as:</p><style>.quote::before{content:var(--quote-emoji)}</style><div class=quote style="--quote-emoji:'üìú'"><h4>Quote</h4><p>"A library for building Haskell IDE tooling"</p></div><p>It is not defined as an IDE, because it only has a subset of the features <a href=https://github.com/haskell/haskell-ide-engine>HIE (Haskell IDE Engine)</a> has. However, the good news is that the HIE and Ghcide teams are joining forces to create <a href=https://neilmitchell.blogspot.com/2020/01/one-haskell-ide-to-rule-them-all.html>One Haskell IDE to rule them all</a>!</p><p>For what it&rsquo;s worth, I&rsquo;ve been using HIE for a while together with my favorite text editor, <a href=https://neovim.io/>NeoVim</a>. It&rsquo;s got a lot of cool features but it&rsquo;s been quite buggy, in my experience.</p><p>Ghcide only offers a few features that work flawlessly, and my experience has been great so far. Though, setting it up to work properly in NeoVim on Ubuntu when all your software has been installed using Nixpkgs hasn&rsquo;t been easy at all.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/6bP_cpJkzdg?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>This is the reason why I am writing this blog post. Aim at those who use Nixpkgs like me, but are on a different distro other than NixOS.</p><h2 id=installing-ghcide>Installing Ghcide</h2><p>If you go to the main Ghcide repository, you&rsquo;ll find instructions on how to install it. For those using Nix, it is officially recommended using <a href=https://github.com/hercules-ci/ghcide-nix>Ghcide-Nix</a>.</p><p>If everything went well, you will find its binary in your Nix profile.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Œª ~ which ghcide
</span></span><span style=display:flex><span>/home/gvolpe/.nix-profile/bin/ghcide
</span></span></code></pre></div><p>To verify Ghcide works, go to any Haskell project or standalone files, and run <code>ghcide</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Œª ~ ghcide
</span></span><span style=display:flex><span>ghcide version: 0.1.0 <span style=color:#f92672>(</span>GHC: 8.6.5<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>PATH: /nix/store/02wcifqr53wjs1m5vn670b1avfy071az-ghcide-0.1.0-exe-ghcide/bin/ghcide<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Ghcide setup tester in /workspace/oss/types-matter.
</span></span><span style=display:flex><span>Report bugs at https://github.com/digital-asset/ghcide/issues
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Step 1/6: Finding files to test in /workspace/oss/types-matter
</span></span><span style=display:flex><span>Found <span style=color:#ae81ff>6</span> files
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Step 2/6: Looking <span style=color:#66d9ef>for</span> hie.yaml files that control setup
</span></span><span style=display:flex><span>Found <span style=color:#ae81ff>1</span> cradle
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Step 3/6, Cradle 1/1: Loading /workspace/oss/types-matter/hie.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Step 4/6, Cradle 1/1: Loading GHC Session
</span></span><span style=display:flex><span>&gt; Warning: The package list <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;hackage.haskell.org&#39;</span> is <span style=color:#ae81ff>15</span> days old.
</span></span><span style=display:flex><span>&gt; Run <span style=color:#e6db74>&#39;cabal update&#39;</span> to get the latest list of available packages.
</span></span><span style=display:flex><span>&gt; Resolving dependencies...
</span></span><span style=display:flex><span>&gt; Build profile: -w ghc-8.6.5 -O1
</span></span><span style=display:flex><span>&gt; In order, the following will be built <span style=color:#f92672>(</span>use -v <span style=color:#66d9ef>for</span> more details<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>&gt;  - types-matter-0.1.0.0 <span style=color:#f92672>(</span>lib<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>configuration changed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>&gt; Configuring library <span style=color:#66d9ef>for</span> types-matter-0.1.0.0..
</span></span><span style=display:flex><span>&gt; Preprocessing library <span style=color:#66d9ef>for</span> types-matter-0.1.0.0..
</span></span><span style=display:flex><span>ghcide: &lt;command line&gt;: cannot satisfy -package-id refined-0.4.4-ea7ce6a6d7ef3587351a3b3bdc4140a3a7bcd0f526627e28a7d5d456e39e9aa9:
</span></span><span style=display:flex><span>    refined-0.4.4-ea7ce6a6d7ef3587351a3b3bdc4140a3a7bcd0f526627e28a7d5d456e39e9aa9 is unusable due to missing dependencies:
</span></span><span style=display:flex><span>      QuickCheck-2.13.2-8aa3fcd8ac86c93ae5db4035083dd975e5b8f88ea826f8604a5748a04c7798bd aeson-1.4.6.0-3a4c86def05154b3acabc0a30d0acd96d235de9d3fd7ba28330e785107e8f5da exceptions-0.10.4-2e686fdff7a6bdbd62e24641169087c094e991de8ab3f6381a859306fd258e32 mtl-2.2.2 prettyprinter-1.3.0-08f8b1f2cf2a49ae7d9056e4ed9fbb3f75b812f789dbb30ab5e82b53b6cc42c8 transformers-0.5.6.2
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>use -v <span style=color:#66d9ef>for</span> more information<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>Yes, you may get a similar output. So let&rsquo;s make it clear.</p><blockquote><p>All software installed by Nix works better within a Nix Shell.</p></blockquote><p>You hear me. If you want this to work, make sure to you have a Nix Shell set up for your project and even run your text editor within a Nix Shell. <em>This is the only sane way</em>.</p><h3 id=configuring-nix-shell>Configuring Nix Shell</h3><p>Nix shell is amazing! It creates an environment where all the necessary software is installed. Once you&rsquo;re done, you leave the shell and come back to your regular terminal. This way we avoid polluting our global environment, i.e. installing unnecessary global software such as Ruby, Node.js, etc.</p><p>Now, there are many ways to properly set up a Nix Shell for a Haskell project. I personally like to use <a href=https://github.com/NixOS/cabal2nix>Cabal2Nix</a> to Nixify my <a href=https://github.com/haskell/cabal>Cabal</a> projects. It basically creates a derivation with all the Haskell packages we need. Here&rsquo;s an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{ mkDerivation<span style=color:#f92672>,</span> aeson<span style=color:#f92672>,</span> async<span style=color:#f92672>,</span> base<span style=color:#f92672>,</span> bytestring<span style=color:#f92672>,</span> co-log-core
</span></span><span style=display:flex><span><span style=color:#f92672>,</span> containers<span style=color:#f92672>,</span> dhall<span style=color:#f92672>,</span> exceptions<span style=color:#f92672>,</span> hedis<span style=color:#f92672>,</span> postgresql-simple
</span></span><span style=display:flex><span><span style=color:#f92672>,</span> raw-strings-qq<span style=color:#f92672>,</span> refined<span style=color:#f92672>,</span> servant<span style=color:#f92672>,</span> servant-server<span style=color:#f92672>,</span> stdenv
</span></span><span style=display:flex><span><span style=color:#f92672>,</span> template-haskell<span style=color:#f92672>,</span> text<span style=color:#f92672>,</span> uuid<span style=color:#f92672>,</span> wai<span style=color:#f92672>,</span> wai-cors<span style=color:#f92672>,</span> warp<span style=color:#f92672>,</span> wreq
</span></span><span style=display:flex><span>}:
</span></span><span style=display:flex><span>mkDerivation {
</span></span><span style=display:flex><span>  pname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;shopping-cart&#34;</span>;
</span></span><span style=display:flex><span>  version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.1.0.0&#34;</span>;
</span></span><span style=display:flex><span>  src <span style=color:#f92672>=</span> <span style=color:#e6db74>./.</span>;
</span></span><span style=display:flex><span>  isLibrary <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  isExecutable <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  libraryHaskellDepends <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    aeson async base bytestring co-log-core containers dhall exceptions
</span></span><span style=display:flex><span>    hedis postgresql-simple raw-strings-qq refined servant
</span></span><span style=display:flex><span>    servant-server template-haskell text uuid wai wai-cors warp wreq
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  executableHaskellDepends <span style=color:#f92672>=</span> [ base ];
</span></span><span style=display:flex><span>  description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;The Shopping Cart developed in PFP Scala for Haskell&#34;</span>;
</span></span><span style=display:flex><span>  license <span style=color:#f92672>=</span> stdenv<span style=color:#f92672>.</span>lib<span style=color:#f92672>.</span>licenses<span style=color:#f92672>.</span>asl20;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This derivation belongs in the <code>shopping-cart.nix</code> file, and it was created from a <code>shopping-cart.cabal</code> file as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cabal2nix . &gt; shopping-cart.nix
</span></span></code></pre></div><p>In my current set up, I have three other Nix files that are needed in order to properly run this project within a Nix Shell: <code>default.nix</code>, <code>release.nix</code>, and <code>shell.nix</code>.</p><p>This is the content of <code>default.nix</code>, which indicates what GHC version we need:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{ nixpkgs <span style=color:#f92672>?</span> <span style=color:#f92672>import</span> <span style=color:#e6db74>&lt;nixpkgs&gt;</span> {}<span style=color:#f92672>,</span> compiler <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;ghc865&#34;</span> }:
</span></span><span style=display:flex><span>nixpkgs<span style=color:#f92672>.</span>pkgs<span style=color:#f92672>.</span>haskell<span style=color:#f92672>.</span>packages<span style=color:#f92672>.</span><span style=color:#e6db74>${</span>compiler<span style=color:#e6db74>}</span><span style=color:#f92672>.</span>callPackage <span style=color:#e6db74>./shopping-cart.nix</span> { }
</span></span></code></pre></div><p>Next is the content of <code>release.nix</code>, which only refers to <code>default.nix</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  pkgs <span style=color:#f92672>=</span> <span style=color:#f92672>import</span> <span style=color:#e6db74>&lt;nixpkgs&gt;</span> { };
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>  pkgs<span style=color:#f92672>.</span>haskellPackages<span style=color:#f92672>.</span>callPackage <span style=color:#e6db74>./default.nix</span> { }
</span></span></code></pre></div><p>Finally, the most important one, <code>shell.nix</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span>{ nixpkgs <span style=color:#f92672>?</span> <span style=color:#f92672>import</span> <span style=color:#e6db74>&lt;nixpkgs&gt;</span> {} }:
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>inherit</span> (nixpkgs) pkgs;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>inherit</span> (pkgs) haskellPackages;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  project <span style=color:#f92672>=</span> <span style=color:#f92672>import</span> <span style=color:#e6db74>./release.nix</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>in</span>
</span></span><span style=display:flex><span>pkgs<span style=color:#f92672>.</span>stdenv<span style=color:#f92672>.</span>mkDerivation {
</span></span><span style=display:flex><span>  name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;shell&#34;</span>;
</span></span><span style=display:flex><span>  buildInputs <span style=color:#f92672>=</span> project<span style=color:#f92672>.</span>env<span style=color:#f92672>.</span>nativeBuildInputs <span style=color:#f92672>++</span> [
</span></span><span style=display:flex><span>    haskellPackages<span style=color:#f92672>.</span>cabal-install
</span></span><span style=display:flex><span>    haskellPackages<span style=color:#f92672>.</span>hlint
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  shellHook <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    export NIX_GHC=&#34;$(which ghc)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    export NIX_GHCPKG=&#34;$(which ghc-pkg)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    export NIX_GHC_DOCDIR=&#34;$NIX_GHC/../../share/doc/ghc/html&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    export NIX_GHC_LIBDIR=&#34;$(ghc --print-libdir)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#39;&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The important part here is our <code>shellHook</code>, which exports a few environment variables needed to get GHC properly detected by Nixpkgs within a Nix Shell.</p><p>Furthermore, these Nix files could probably be simplified into two files or maybe a single one but, to be honest, I haven&rsquo;t bothered in trying to do so. Nix is amazing when it works but, when it doesn&rsquo;t, it&rsquo;s a huge pain to find out what&rsquo;s going on.</p><p>You can find all these Nix files in this <a href=https://github.com/gvolpe/shopping-cart-haskell>Github repository</a>.</p><h2 id=troubleshooting>Troubleshooting</h2><p>There could be a lot of different things going wrong. We have seen a first common error above, but there could be a few others. Find below a summary of common issues.</p><h3 id=error-1>Error #1</h3><p>The following error is one of the most common ones:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cannot satisfy -package-id ghc-8.6.5
</span></span></code></pre></div><p>I have reported <a href=https://github.com/digital-asset/ghcide/issues/439>this issue</a>. This seems to happen because the GHC version detected by Ghcide is not the same it is expected by the Cabal project. Fortunately, this is fixed by the export of the environment variables defined in our <code>shellHook</code>.</p><p>Notice that the error message might show a different package, such as <code>aeson</code>, not only <code>ghc</code>. The fix seems to be the same, though.</p><h3 id=error-2>Error #2</h3><p>You may get a lot of the following errors as well:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Step 6/6: Type checking the files
</span></span><span style=display:flex><span>File:     /workspace/oss/shopping-cart-haskell/app/Main.hs
</span></span><span style=display:flex><span>Hidden:   no
</span></span><span style=display:flex><span>Range:    5:17-5:28
</span></span><span style=display:flex><span>Source:   not found
</span></span><span style=display:flex><span>Severity: DsError
</span></span><span style=display:flex><span>Message:
</span></span><span style=display:flex><span>  Could not find module ‚ÄòHttp.Server‚Äô
</span></span><span style=display:flex><span>  It is not a module in the current program, or in any known package.
</span></span></code></pre></div><p>This is normally fixed by creating a specific <code>hie.yaml</code> file, indicating <a href=https://github.com/mpickering/hie-bios>hie-bios</a> how to read our project. Here&rsquo;s the one defined in the Shopping Cart project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cradle: <span style=color:#f92672>{</span>cabal: <span style=color:#f92672>{</span>component: <span style=color:#e6db74>&#34;lib:shopping-cart&#34;</span><span style=color:#f92672>}}</span>
</span></span></code></pre></div><p>You will still get the same error with your <code>Setup.hs</code> file, defined by Cabal:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Message:
</span></span><span style=display:flex><span>  Could not load module ‚ÄòDistribution.Simple‚Äô
</span></span><span style=display:flex><span>  It is a member of the hidden package ‚ÄòCabal-2.4.0.1‚Äô.
</span></span><span style=display:flex><span>  Perhaps you need to add ‚ÄòCabal‚Äô to the build-depends in your .cabal file.
</span></span><span style=display:flex><span>Files that failed:
</span></span><span style=display:flex><span> * /workspace/oss/shopping-cart-haskell/Setup.hs
</span></span></code></pre></div><p>However, it doesn&rsquo;t matter. Ghcide will still work in our project; this is not an issue.</p><h3 id=error-3>Error #3</h3><p>The following error is somewhat a nasty one:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Error ghcide: &lt;command line&gt;: can<span style=color:#960050;background-color:#1e0010>&#39;</span>t load .so/.DLL
</span></span></code></pre></div><p>If you stumble upon this one, make sure to update to the latest version. I had this error, which is reported <a href=https://github.com/digital-asset/ghcide/issues/404>here</a>, and got it fixed after updating Ghcide.</p><h2 id=bonus-track>Bonus Track</h2><p>As I have got used to having a linter and a formatter integrated in NeoVim when using HIE, I kind of miss these features, which are probably going to land in the future Haskell IDE as plugins.</p><p>So I came up with a few (temporary) commands to get <a href=https://github.com/ndmitchell/hlint>HLint</a> and <a href=https://github.com/lspitzner/brittany/>Brittany</a> integrated in NeoVim.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vim data-lang=vim><span style=display:flex><span><span style=color:#a6e22e>nnoremap</span> &lt;<span style=color:#a6e22e>leader</span>&gt;<span style=color:#a6e22e>af</span> :<span style=color:#a6e22e>r</span> !<span style=color:#a6e22e>brittany</span> --<span style=color:#a6e22e>write</span>-<span style=color:#a6e22e>mode</span>=<span style=color:#a6e22e>inplace</span> %:<span style=color:#a6e22e>p</span>&lt;<span style=color:#a6e22e>CR</span>&gt;
</span></span><span style=display:flex><span><span style=color:#a6e22e>nnoremap</span> &lt;<span style=color:#a6e22e>leader</span>&gt;<span style=color:#a6e22e>al</span> :<span style=color:#a6e22e>AsyncRun</span> <span style=color:#a6e22e>hlint</span> %:<span style=color:#a6e22e>p</span>&lt;<span style=color:#a6e22e>CR</span>&gt;
</span></span></code></pre></div><p>The first one runs <code>brittany</code> on the current file in the buffer and applies its output <em>inplace</em>. The latter runs <code>hlint</code>
for the current file in the buffer and it displays its result in a quickfix window. It uses the <a href=https://github.com/skywind3000/asyncrun.vim>asyncrun.vim</a> plugin.</p><p>If you are interested in my full configuration, you can find it <a href=https://github.com/gvolpe/nix-config>here</a>.</p><p>The future of IDEs in Haskell is only getting brighter :)</p><p>Gabriel.</p></div><div class=related-posts><h3>Related Content</h3><div class=related-grid><div class=related-post><h4><a href=https://gvolpe.com/blog/functional-dependencies-and-type-families/>Functional Dependencies & Type Families</a></h4><div class=related-meta>2019.08.27 ‚Ä¢
üìöüìöüìöüìöüìö 6 min read</div></div><div class=related-post><h4><a href=https://gvolpe.com/talks/medellin-2019/>Entering a Purely Functional World @ Scala MDE Meetup 2019 - Medellin, CO üá®üá¥</a></h4><div class=related-meta>2019.08.09 ‚Ä¢
üéôÔ∏è Public Talk</div></div><div class=related-post><h4><a href=https://gvolpe.com/blog/lessons-learned-while-writing-a-haskell-app/>Lessons learned while writing a Haskell application</a></h4><div class=related-meta>2019.06.23 ‚Ä¢
üìöüìöüìöüìöüìö 9 min read</div></div></div></div><nav class=post-navigation><div class=nav-previous><span class=nav-label>‚Üê Previous</span>
<a href=https://gvolpe.com/blog/the-art-of-interviewing-engineers/ class=nav-title>The art of interviewing engineers</a></div><div class=nav-next><span class=nav-label>Next ‚Üí</span>
<a href=https://gvolpe.com/blog/parallel-typeclass-for-haskell/ class=nav-title>Parallel typeclass for Haskell</a></div></nav></article><aside class=sidebar><nav class=toc><h4>Contents</h4><div id=toc-content></div></nav></aside></div></div></div></main><script src=https://gvolpe.com/js/email.js></script><script src=https://gvolpe.com/js/main.js></script></body></html>